// Generated by CoffeeScript 1.10.0
(function() {
  var compressMap, prop, reverseMap, value;

  compressMap = {
    "children": "$c",
    "contentString": "$s",
    "type": "$t",
    "spell": "$p",
    "state": "$t",
    "doneAt": "$a"
  };

  reverseMap = {};

  for (prop in compressMap) {
    value = compressMap[prop];
    reverseMap[value] = prop;
  }

  exports._compress = function(obj) {
    var result;
    if (obj instanceof Array) {
      return obj.map(this._compress.bind(this));
    }
    if (typeof obj === "object") {
      result = {};
      for (prop in obj) {
        value = obj[prop];
        if (value instanceof Array && value.length === 0) {
          continue;
        }
        if (compressMap[prop]) {
          result[compressMap[prop]] = this._compress(value);
        } else {
          result[prop] = this._compress(value);
        }
      }
      return result;
    }
    return obj;
  };

  exports.compress = function(obj) {
    var result;
    result = this._compress(obj);
    result.$v = 0;
    return result;
  };

  exports.extract = function(obj) {
    if (obj.$v !== 0) {
      return obj;
    }
    return this._extract(obj);
  };

  exports._extract = function(obj) {
    var result;
    if (obj instanceof Array) {
      return obj.map(this._extract.bind(this));
    }
    if (typeof obj === "object") {
      result = {};
      for (prop in obj) {
        value = obj[prop];
        if (prop[0] === "$") {
          result[reverseMap[prop]] = this._extract(value);
        } else {
          result[prop] = this._extract(value);
        }
      }
      return result;
    }
    return obj;
  };

}).call(this);
